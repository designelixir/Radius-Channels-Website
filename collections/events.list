


<script>

function isDateInFutureOrPast(start, end, id) {
	const today = new Date();
	var targetParentId = document.getElementById(String(id))
	var targetId = document.getElementById('eventType-' + String(id))
	const startDate = new Date(start)
	const endDate = new Date(end)
	if (startDate > today) {
		targetId.insertAdjacentHTML("afterbegin", "Upcoming")
		targetParentId.classList.add('future-event')
	} else if (startDate < today && endDate > today){
		targetId.insertAdjacentHTML("afterbegin", "Upcoming")
		targetParentId.classList.add('future-event')
	} else if (startDate < today) {
		targetParentId.classList.add('past-event')
		targetId.insertAdjacentHTML("afterbegin", "Archived")
		targetParentId.classList.add('archived-event')
	}  else {
	console.log("no event defined")
	}
}

function toggleTypes(toggleType){
	var typeToggles = document.getElementsByClassName('type-toggle'); 
	var futureEvents = document.getElementsByClassName('future-event')
	var archivedEvents = document.getElementsByClassName('archived-event')
	var allContentDivs = document.getElementsByClassName('events-summary-container')
	var lastArchiveEventIndex = archivedEvents.length - 1;
	

	for (var i = 0; i < typeToggles.length; i++){
	typeToggles[i].classList.remove('active-type-toggle')
	}
	document.getElementById(toggleType).classList.add('active-type-toggle')

	for (var i = 0; i < allContentDivs.length; i++){
		allContentDivs[i].classList.remove('visible-event', 'active-event')
	}

		if (toggleType === 'upcoming-toggle' && futureEvents.length > 0){
			document.getElementById('noEvents').style.display = "none"
			document.getElementById('target-iframe').style.display = "block"
			document.getElementById('eventList').style.flexDirection = "column"
			toggleEvent(futureEvents[0].id, futureEvents[0].dataset.fullUrl)
			
			for (var i = 0; i < futureEvents.length; i++){
				futureEvents[i].classList.add('visible-event')
			} 
		} else if (toggleType === 'upcoming-toggle' && futureEvents.length === 0) {
			document.getElementById('noEvents').style.display = "block"
			document.getElementById('target-iframe').style.display = "none"
		}
		else {
			toggleEvent(archivedEvents[lastArchiveEventIndex].id, archivedEvents[lastArchiveEventIndex].dataset.fullUrl)
			document.getElementById('noEvents').style.display = "none"
			document.getElementById('target-iframe').style.display = "block"
			document.getElementById('eventList').style.flexDirection = "column-reverse"
			
			for (var i = 0; i < archivedEvents.length; i++){
				archivedEvents[i].classList.add('visible-event')
			}
		}
}
	
function toggleEvent(target, fullUrl){
	var targetIframe = document.getElementById('target-iframe');
	var targetUrl = "https://radiuschannels2.squarespace.com" + String(fullUrl)
	var targetDiv = document.getElementById(target);
	var allDivs = document.getElementsByClassName('active-event')
	for (i=0; i < allDivs.length; i++){
		allDivs[i].classList.remove('active-event')
	}
	targetDiv.classList.add('active-event')
	targetIframe.src = targetUrl
}
</script>
<header class="site-header">
	<squarespace:navigation navigationId="siteNav" template="site-navigation" />
</header>
<div id='site-wrapper'>
	{.section website}
	<div {.if collection.mainImage} style="background-image: url({collection.mainImage.assetUrl})" class="user-set-bg page-header"{.or} class="page-header" {.end}>
	<div class="page-header-content">
		<div>
			<h1 class="site-title-heading" data-content-field="site-title" {.if collection.mainImage} style="color: white" {.end}>
			{collection.title}
			</h1>
		</div>
	</div>
</div>
{.end}
<div class="content-container">
	<div class="flex-start-start event-type-toggles">
		<h2 id="upcoming-toggle" class="active-type-toggle type-toggle hover" onclick="toggleTypes('upcoming-toggle')">Upcoming Events </h2>
		<h2>&nbsp;/&nbsp; </h2>
		<h2 id="archive-toggle" class="type-toggle hover" onclick="toggleTypes('archive-toggle')">Archived Events</h2>
	</div>
	<p id="noEvents" style="display: none">No upcoming events to show. <span onclick="toggleTypes('archive-toggle')" class="hover">View our Archived Events!</span></p>
	<div class="events flex-start-start">
		<div class="events-summary-list flex-start-start" id="eventList">
		
		
		
			{.repeated section items}
			<div class="flex-center-center events-summary-container"  id="{id}" data-full-url="{fullUrl}">
				<div class="events-summary" onclick="toggleEvent('{id}', '{fullUrl}')"  >
					<div class="events-summary-wrapper flex-center-center">
						<div class="event-summary-info">
							<div class="event-summary-wrapper flex-start-start">
								<div class="event-summary-title">
									<span id="eventType-{id}" class="event-status">
									{.if customContent.eventType}
										- Virtual Event
										{.or}
										- In-Person Event
										{.end}</span>
									<p>{structuredContent.startDate|date %B %d, %Y}</p>
									<h3 class="strong hover">{title}</h3>
									<div class="excerpt">
										<p id="trimmed-excerpt">{excerpt|truncate 220}</p>
									</div>
									<div class="flex-start-start">
										{.repeated section tags}
										<p class="tag">{@}</p>
										{.alternates with}&nbsp;
										{.end}
										
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<script>isDateInFutureOrPast(`{structuredContent.startDate|date %Y-%m-%dT%T}`, `{structuredContent.endDate|date %Y-%m-%dT%T}`, '{id}')</script>
			{.end}	
		</div>
		<div class="events-full-size" style="width: 60%;">
			<div class="full-size-event" id="full-size-iframe">
				<iframe id="target-iframe" width="100%" height="900px"></iframe>	
			</div>
		</div>
	</div>
</div>
</div>
<script>
var futureEventsLength = document.getElementsByClassName('future-event')
if (futureEventsLength.length > 0){
	toggleTypes('upcoming-toggle')
} else {
	document.getElementById('noEvents').style.display = "block"
}
	
</script>
